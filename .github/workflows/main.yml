on:
  # Trigger the workflow on push or pull request
  pull_request:
    branches:
      - main

permissions:
  issues: write
  pull-requests: write
  
jobs:
  comment:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout the repo
        uses: actions/checkout@v3

      - uses: peter-evans/create-or-update-comment@v3
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          issue-number: ${{ github.event.pull_request.number }}
          body: |
            ðŸ‘‹ Hello from **GitHub Actions** marketplace!

            Here's a variable `${{ github.ref_name }}` and `${{ github.event.pull_request.number }}`
            
            Hereâ€™s a table:
      
            | Feature       | Supported |
            | ------------- | --------- |
            | Multiline     | âœ…        |
            | Bold          | âœ…        |
            | Links         | âœ…        |
      
            ```js
            console.log("This is a code block!");
            ```
            
            [Docs](https://github.com/your-org/your-repo)

      - name: Add comment to PR
        run: |
          MESSAGE="ðŸš€ Deployment triggered on branch: \`${{github.ref_name}}\`"
          COMMIT_MSG="${{ github.event.head_commit.message }}"
          
          gh pr comment "$PR_NUMBER" --body $'ðŸ‘‹ Hello from **GitHub Actions** gh cli!\nHere are variables $MESSAGE $COMMIT_MSG \nHereâ€™s a table:\n\n| Feature       | Supported |\n| ------------- | --------- |\n| Multiline     | âœ…        |\n| Bold          | âœ…        |\n| Links         | âœ…        |\n\n```js\nconsole.log("Hello from gh!");\n```\n\n[Docs](https://github.com)'
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          PR_NUMBER: ${{ github.event.pull_request.number }}
          
      - name: Comment on pull request
        run: |
          BRANCH="${{ github.ref_name }}"
          COMMIT_MSG="${{ github.event.pull_request.number }}"
          
          COMMENT_BODY=$(cat <<EOF
          ðŸ‘‹ Hello from **GitHub Actions**!

          Branch: \`$BRANCH\`
          PR: \`$COMMIT_MSG\`
          Hereâ€™s a table:
          
          | Feature       | Supported |
          | ------------- | --------- |
          | Multiline     | âœ…        |
          | Bold          | âœ…        |
          | Links         | âœ…        |
          
          \`\`\`js
          console.log("This is a code block!");
          \`\`\`
          
          [Docs](https://github.com)
          EOF
          )
          
          curl -s -X POST -H "Authorization: token ${{ secrets.GITHUB_TOKEN }}" \
            -H "Content-Type: application/json" \
            -d "$(jq -nc --arg body "$COMMENT_BODY" '{body: $body}')" \
            "https://api.github.com/repos/${{ github.repository }}/issues/${{ github.event.pull_request.number }}/comments"
            
